# ğŸ› DebugåŠŸèƒ½ä½¿ç”¨æŒ‡å—

DebugåŠŸèƒ½å¯ä»¥å¸®åŠ©æ‚¨è°ƒè¯•DeepSearchåº”ç”¨ä¸­çš„APIè¯·æ±‚å’Œæ•°æ®è·å–é—®é¢˜ï¼Œå°†æ‰€æœ‰è¯·æ±‚å’Œå“åº”æ•°æ®ä¿å­˜åˆ°JSONæ–‡ä»¶ä¸­ä¾›åˆ†æã€‚

## ğŸ“‹ åŠŸèƒ½ç‰¹ç‚¹

- âœ… **APIè¯·æ±‚è®°å½•** - è®°å½•æ‰€æœ‰å‘é€åˆ°Gemini APIçš„è¯·æ±‚
- âœ… **APIå“åº”è®°å½•** - è®°å½•æ‰€æœ‰æ¥è‡ªAPIçš„å“åº”æ•°æ®
- âœ… **æœç´¢ç»“æœè®°å½•** - è®°å½•æœç´¢åŠŸèƒ½çš„å®Œæ•´ç»“æœ
- âœ… **å·¥ä½œæµæ­¥éª¤è®°å½•** - è®°å½•ç ”ç©¶è¿‡ç¨‹ä¸­çš„æ¯ä¸ªæ­¥éª¤
- âœ… **é”™è¯¯è®°å½•** - è®°å½•æ‰€æœ‰é”™è¯¯å’Œå¼‚å¸¸
- âœ… **ä¼šè¯æ‘˜è¦** - ç”Ÿæˆç»Ÿè®¡æ‘˜è¦ä¿¡æ¯
- âœ… **å¤§æ•°æ®å¤„ç†** - è‡ªåŠ¨æˆªæ–­è¿‡å¤§çš„æ•°æ®ä»¥é¿å…æ–‡ä»¶è¿‡å¤§

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. å¯ç”¨Debugæ¨¡å¼

åœ¨DeepSearchåº”ç”¨çš„ä¾§è¾¹æ ä¸­ï¼š

1. ç¡®ä¿æ‚¨çš„APIå¯†é’¥å·²æ­£ç¡®é…ç½®
2. å‘ä¸‹æ»šåŠ¨åˆ°"ğŸ› Debugæ¨¡å¼"éƒ¨åˆ†
3. å‹¾é€‰"å¯ç”¨è°ƒè¯•æ¨¡å¼"å¤é€‰æ¡†
4. æ‚¨ä¼šçœ‹åˆ°æç¤ºï¼š"Debugæ¨¡å¼å·²å¯ç”¨"

### 2. è¿›è¡Œç ”ç©¶æ“ä½œ

å¯ç”¨Debugæ¨¡å¼åï¼Œæ­£å¸¸ä½¿ç”¨DeepSearchè¿›è¡Œç ”ç©¶ï¼š

1. è¾“å…¥æ‚¨çš„ç ”ç©¶é—®é¢˜
2. é€‰æ‹©ç ”ç©¶å¼ºåº¦
3. ç‚¹å‡»"ğŸš€ å¼€å§‹ç ”ç©¶"
4. DebugåŠŸèƒ½ä¼šåœ¨åå°è‡ªåŠ¨è®°å½•æ‰€æœ‰æ´»åŠ¨

### 3. æŸ¥çœ‹Debugç»Ÿè®¡

åœ¨Debugæ¨¡å¼å¯ç”¨åï¼Œä¾§è¾¹æ ä¼šæ˜¾ç¤ºï¼š

- ğŸ“ **ä¼šè¯ID** - å½“å‰debugä¼šè¯çš„å”¯ä¸€æ ‡è¯†
- ğŸ“Š **Debugç»Ÿè®¡** - å®æ—¶ç»Ÿè®¡ä¿¡æ¯
  - APIè¯·æ±‚æ•°é‡
  - æœç´¢æ¬¡æ•°
  - é”™è¯¯æ•°é‡

### 4. ä¿å­˜Debugæ—¥å¿—

- **è‡ªåŠ¨ä¿å­˜**: ç ”ç©¶å®Œæˆåè‡ªåŠ¨ä¿å­˜
- **æ‰‹åŠ¨ä¿å­˜**: ç‚¹å‡»"ğŸ’¾ ä¿å­˜Debugæ—¥å¿—"æŒ‰é’®ç«‹å³ä¿å­˜

## ğŸ“ æ–‡ä»¶ç»“æ„

Debugæ—¥å¿—ä¿å­˜åœ¨ `debug_logs/` ç›®å½•ä¸‹ï¼š

```
debug_logs/
â”œâ”€â”€ debug_session_20250612_215439.json          # å®Œæ•´ä¼šè¯æ•°æ®
â””â”€â”€ debug_session_20250612_215439_summary.json  # ä¼šè¯æ‘˜è¦
```

### å®Œæ•´ä¼šè¯æ–‡ä»¶ç»“æ„

```json
{
  "session_info": {
    "session_id": "debug_session_20250612_215439",
    "start_time": "2025-06-12T21:54:39.123456",
    "end_time": "2025-06-12T21:56:12.789012"
  },
  "api_requests": [
    {
      "timestamp": "2025-06-12T21:54:40.123456",
      "request_id": "search_1734567890123",
      "request_type": "search_with_grounding",
      "model": "gemini-2.0-flash",
      "prompt": "ç”¨æˆ·æŸ¥è¯¢å†…å®¹...",
      "config": {
        "temperature": 0.1,
        "max_output_tokens": 8192
      },
      "response": {
        "timestamp": "2025-06-12T21:54:42.456789",
        "text": "APIå“åº”å†…å®¹...",
        "metadata": {
          "has_grounding": true,
          "search_queries": ["æŸ¥è¯¢1", "æŸ¥è¯¢2"]
        },
        "status": "success"
      }
    }
  ],
  "search_results": [
    {
      "timestamp": "2025-06-12T21:54:42.456789",
      "query": "ç”¨æˆ·æŸ¥è¯¢",
      "search_type": "grounding",
      "success": true,
      "content_length": 1500,
      "citations_count": 3,
      "has_grounding": true,
      "full_result": {
        // å®Œæ•´çš„æœç´¢ç»“æœæ•°æ®
      }
    }
  ],
  "workflow_steps": [
    {
      "timestamp": "2025-06-12T21:54:39.123456",
      "step_name": "research_start",
      "step_status": "running",
      "input_data": {
        "user_query": "ç”¨æˆ·æŸ¥è¯¢",
        "max_search_rounds": 3,
        "effort_level": "medium"
      }
    }
  ],
  "research_results": [
    {
      "timestamp": "2025-06-12T21:56:12.123456",
      "user_query": "ç”¨æˆ·æŸ¥è¯¢",
      "final_answer_length": 2500,
      "success": true,
      "full_result": {
        // å®Œæ•´çš„ç ”ç©¶ç»“æœ
      }
    }
  ],
  "errors": [
    {
      "timestamp": "2025-06-12T21:55:30.123456",
      "error_type": "SearchError",
      "error_message": "é”™è¯¯æè¿°",
      "context": {
        "query": "å¯¼è‡´é”™è¯¯çš„æŸ¥è¯¢",
        "model": "gemini-2.0-flash"
      },
      "stacktrace": "Pythoné”™è¯¯å †æ ˆ..."
    }
  ]
}
```

### æ‘˜è¦æ–‡ä»¶ç»“æ„

```json
{
  "session_id": "debug_session_20250612_215439",
  "total_api_requests": 5,
  "successful_api_requests": 4,
  "total_searches": 3,
  "successful_searches": 3,
  "total_workflow_steps": 8,
  "completed_steps": 7,
  "total_errors": 1,
  "research_results": 1
}
```

## ğŸ” åˆ†æDebugæ•°æ®

### 1. éªŒè¯APIè¯·æ±‚

æ£€æŸ¥APIè¯·æ±‚æ˜¯å¦æ­£ç¡®å‘é€ï¼š

```python
import json

# åŠ è½½debugæ•°æ®
with open('debug_logs/debug_session_xxx.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# æŸ¥çœ‹APIè¯·æ±‚
for request in data['api_requests']:
    print(f"è¯·æ±‚ID: {request['request_id']}")
    print(f"æ¨¡å‹: {request['model']}")
    print(f"çŠ¶æ€: {request.get('response', {}).get('status', 'æ— å“åº”')}")
```

### 2. åˆ†ææœç´¢ç»“æœ

æ£€æŸ¥æœç´¢æ˜¯å¦è·å–äº†æ­£ç¡®çš„æ•°æ®ï¼š

```python
# æŸ¥çœ‹æœç´¢ç»“æœ
for search in data['search_results']:
    print(f"æŸ¥è¯¢: {search['query']}")
    print(f"æˆåŠŸ: {search['success']}")
    print(f"å†…å®¹é•¿åº¦: {search['content_length']}")
    print(f"å¼•ç”¨æ•°é‡: {search['citations_count']}")
```

### 3. è¿½è¸ªå·¥ä½œæµæ‰§è¡Œ

äº†è§£ç ”ç©¶è¿‡ç¨‹çš„æ¯ä¸ªæ­¥éª¤ï¼š

```python
# æŸ¥çœ‹å·¥ä½œæµæ­¥éª¤
for step in data['workflow_steps']:
    print(f"{step['timestamp']}: {step['step_name']} - {step['step_status']}")
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®æ•æ„Ÿæ€§**: Debugæ–‡ä»¶å¯èƒ½åŒ…å«APIå¯†é’¥ä¿¡æ¯ï¼Œè¯·å¦¥å–„ä¿ç®¡
2. **æ–‡ä»¶å¤§å°**: é•¿æ—¶é—´çš„ç ”ç©¶ä¼šäº§ç”Ÿè¾ƒå¤§çš„JSONæ–‡ä»¶
3. **æ€§èƒ½å½±å“**: Debugæ¨¡å¼ä¼šè½»å¾®å½±å“æ€§èƒ½ï¼Œä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­é•¿æœŸå¼€å¯
4. **å­˜å‚¨ç©ºé—´**: å®šæœŸæ¸…ç†æ—§çš„debugæ–‡ä»¶ä»¥èŠ‚çœå­˜å‚¨ç©ºé—´

## ğŸ› ï¸ æ•…éšœæ’é™¤

### é—®é¢˜1: Debugæ–‡ä»¶æœªç”Ÿæˆ

**å¯èƒ½åŸå› **:
- Debugæ¨¡å¼æœªæ­£ç¡®å¯ç”¨
- ç ”ç©¶è¿‡ç¨‹ä¸­å‡ºç°ä¸¥é‡é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤ä¾§è¾¹æ æ˜¾ç¤º"Debugæ¨¡å¼å·²å¯ç”¨"
2. æ‰‹åŠ¨ç‚¹å‡»"ä¿å­˜Debugæ—¥å¿—"æŒ‰é’®
3. æ£€æŸ¥ `debug_logs/` ç›®å½•æƒé™

### é—®é¢˜2: JSONæ–‡ä»¶æ ¼å¼é”™è¯¯

**å¯èƒ½åŸå› **:
- æ•°æ®è¿‡å¤§å¯¼è‡´æˆªæ–­
- ç‰¹æ®Šå­—ç¬¦ç¼–ç é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**:
1. ä½¿ç”¨æ”¯æŒå¤§æ–‡ä»¶çš„JSONæŸ¥çœ‹å™¨
2. æ£€æŸ¥æ–‡ä»¶ç¼–ç æ˜¯å¦ä¸ºUTF-8

### é—®é¢˜3: æ‰¾ä¸åˆ°debug_logsç›®å½•

**è§£å†³æ–¹æ¡ˆ**:
1. ç›®å½•ä¼šåœ¨é¦–æ¬¡å¯ç”¨Debugæ¨¡å¼æ—¶è‡ªåŠ¨åˆ›å»º
2. æ‰‹åŠ¨åˆ›å»º `debug_logs/` ç›®å½•
3. æ£€æŸ¥åº”ç”¨è¿è¡Œç›®å½•çš„å†™å…¥æƒé™

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°DebugåŠŸèƒ½ç›¸å…³é—®é¢˜ï¼š

1. æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºä¸­çš„debugä¿¡æ¯
2. æ£€æŸ¥JSONæ–‡ä»¶çš„æ ¼å¼å®Œæ•´æ€§
3. å°è¯•é‡æ–°å¯ç”¨Debugæ¨¡å¼
4. æŸ¥çœ‹åº”ç”¨æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

---

*Happy Debugging! ğŸ›* 